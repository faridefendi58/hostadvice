var CompaniesSearch={companySearchTimer:'',init:function(params){var self=this,ajaxUrl=typeof ajaxUrl_ht!=='undefined'?ajaxUrl_ht:ajaxurl;if(params.searchResultsClass===undefined){params.searchResultsClass="company-search-choice";}
if(jQuery(params.inputSelector)!==undefined&&jQuery(params.inputSelector).length&&ajaxUrl!==undefined&&((jQuery(params.companyIdInpSelector)!==undefined&&jQuery(params.companyIdInpSelector).length)||params.selectFunction!==undefined)){if(params.selectFunction===undefined){params.selectFunction=function(event,ui){jQuery(params.companyIdInpSelector).val(ui.item.post_id)};}
var options={source:function(request,response){request['action']='companies_search';if(params.getRequestParams!==undefined){var requestParams=params.getRequestParams();for(var key in requestParams){request[key]=requestParams[key];}}
jQuery.post(ajaxUrl,request,function(data){response(data);});},create:function(){jQuery(this).data('ui-autocomplete')._renderItem=function(ul,item){if(params.resultsHolderClass!==undefined){ul.addClass(params.resultsHolderClass);}else{ul.addClass('companies-search-results-holder');}
return jQuery("<li>").attr({"class":params.searchResultsClass,"data-company-id":item.post_id}).html(item.label).appendTo(ul);};},response:function(event,ui){if(typeof params.autoSelect!=='undefined'&&params.autoSelect===true){var search=jQuery(this).val(),data=ui.content;jQuery.each(data,function(i,v){if(v.label.toLowerCase()==search.toLowerCase()){params.selectFunction(event,{item:v});}});}},autoFocus:true,minLength:0,select:params.selectFunction};if(params.appendToSelector!==undefined&&jQuery(params.appendToSelector).length){options.appendTo=params.appendToSelector;}
if(params.loaderSelector!==undefined&&jQuery(params.loaderSelector).length){options.search=function(event,ui){jQuery(params.loaderSelector).show();};options.open=function(event,ui){jQuery(params.loaderSelector).hide();};}
jQuery(params.inputSelector).autocomplete(options);}}}