var companiesSearchInit;jQuery(function($){var cache={};companiesSearchInit=function(){$(".companies-search-form .big-input").each(function(){var additional_class='';if($(this).closest('#secondary').length>0){additional_class='sidebar';}
$(this).autocomplete({source:function(request,response){var term=request.term;if(term in cache){response(cache[term]);return;}
request['action']='companies_search';request['limit']=7;$.post(ajaxUrl_ht,request,function(data){cache[term]=data;response(data);});},autoFocus:true,minLength:0,select:function(event,ui){if(ui.item&&typeof ui.item.href!='undefined'){location.href=ui.item.href;}},create:function(event,ui){$(this).data('ui-autocomplete')._renderMenu=function(ul,items){var self=this;$.each(items,function(index,item){self._renderItemData(ul,item);});self._renderItemData(ul,{'value':self.term,label:tr('More results'),href:'/?s='+self.term});}}}).data('uiAutocomplete')._renderItem=function(ul,item){var $icon=null,$liClass=typeof item['no_matches']!==undefined&&item['no_matches']?'autocomplete-no-matches':'';ul.addClass(additional_class);if(typeof item.icon!='undefined'){$icon=$('<img />').attr({'src':item.icon});$icon=$('<span class="icon-holder"></span>').append($icon);}
var $link=$('<a/>').attr({'class':'clearfix','data-ga-event':'autocomplete search click','title':item.label});if(typeof item.href=='undefined'){$link.attr('href','javascript: void(0);');}else{$link.attr('href',item.href);}
$link.html('<span class="title">'+item.label+'</span>');if($icon!=null){$link.prepend($icon);}
if(item.score!='0'){}
if(item.recommend>0||item.not_recommend>0){var $recommend='<span class="like-unlike-holder"><span class="red-hand">'+item.not_recommend+'</span><span class="green-hand">'+item.recommend+'</span></span>';$link.append($recommend);}
return $("<li>").attr({"class":$liClass}).append($link).appendTo(ul);};});$(".companies-search-form .big-submit").on('click',function(e){e.preventDefault();$(this).closest('form').find('.big-input').autocomplete("search");});$(".companies-search-form").on('submit',function(e){e.preventDefault();$(this).find('.big-input').autocomplete("search");});};companiesSearchInit();});